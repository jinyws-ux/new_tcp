## 目标
- 在“解析逻辑配置”的字段添加流程中，支持从历史字段库中快速选择并自动填充字段名称、Start、Length（必要时带出 Escapes）。
- 保留现有“手动填写”模式；当需要“与以前一样”的字段时，直接选取历史项。

## 前端改动
- 在 `#add-field-modal` 中新增“历史字段”选择区（搜索 + 列表），与现有手动输入并存：
  - 搜索框：支持按字段名模糊搜索；
  - 列表项：展示 `字段名 / Start / Length / 使用次数`；
  - 操作：点击历史项后自动填充 `#field-name`, `#field-start`, `#field-length`；仍可在填充后微调。
- 数据来源：前端基于 `workingConfig` 直接构建历史字段库（避免后端改动）：
  - 遍历 `workingConfig[mt].Versions[ver].Fields` 收集所有字段；
  - 以 `(name, Start, Length)` 作为去重键，累积 `usageCount`（统计出现次数）；
  - 兼容 `Length=null/-1` 表示“到结尾”。
- 交互入口：
  - 在版本编辑视图（renderEditorFor type=version）里，“添加字段”按钮打开新增模态框，默认聚焦历史字段搜索；
  - 在字段编辑视图增加“复制字段到剪贴板”的同时也增加“添加同款字段到本版本”快捷入口（调用同一填充流程）。

## 后端（可选增强，当前不强制）
- 新增 API：`GET /api/parser-config-fields?factory=&system=`，由后端聚合生成字段库，返回结构：
  - `[{ name, start, length, usageCount, examples: [{mt, ver}] }]`
- 作用：
  - 当配置规模很大时，前端计算可能稍慢；后端返回可加速并复用；
  - 支持跨会话缓存与收藏（比如“常用字段”）。
- 现阶段先用前端聚合，后续如需后端缓存再补充此接口。

## 兼容与边界
- 当同名字段在不同版本/类型有不同的 Start/Length：
  - 历史库中将出现多个条目（按 `(name, Start, Length)` 维度区分），由使用次数排序，避免误选。
- 当 `Length=null/-1`：
  - 前端显示为“到结尾”；填充时保留原语义（提交为 `-1`）。
- Escapes：
  - 默认仅填充结构字段（name/start/length）。如需同时复用 Escapes，可勾选“带出转义”；
  - 勾选后会在添加后，自动将历史项的 `Escapes` 合并到新字段（名称相同则覆盖）。

## UI 改动点（代码锚点）
- `web/static/js/modules/parser-config.js`
  - `showAddFieldModal(mt, ver)`：弹窗中插入“历史字段选择区”（搜索 + 列表），并在选择后填充表单；
  - 新增 `buildFieldLibrary(workingConfig)`：聚合 `(name, Start, Length)` 的历史字段；
  - 新增 `renderFieldLibrary(list)` 与事件绑定；
  - `submitFieldForm()`：沿用已有提交逻辑，无需改动；
- 保持现有剪贴板机制（复制/粘贴）可并存，历史选择是更便捷的补充。

## 验证
- 在当前工厂/系统加载的配置下：
  - 打开版本视图 → 点击“添加字段” → 历史字段列表展示；
  - 选择一个历史项 → 自动填充 → 保存后刷新树与 JSON 预览；
  - 回归测试：
    - 手动新建字段仍可用；
    - 选择不同 Start/Length 的同名字段可正确填充；
    - 勾选“带出转义”验证转义拷贝合并逻辑。

## 迭代（后续可选）
- 历史字段收藏/置顶；
- 按报文类型/版本过滤历史字段；
- 后端缓存与常用字段统计；
- 将可视化解析构建器中的字段也纳入历史库来源。